
模板管理
=======================

说明
-----------------------
- 管理模板

1、模板列表、新增模板、批量删除模板 API
-----------------------------------------------

**请求方式：**    GET（查询） POST（新增） DELETE（批量删除）


**请求地址：**    /api/template/template/


**Content-Type：**
::
    新增数据的时候需要指定Content-Type，以下对Content-Type进行说明:

    application/x-www-form-urlencoded —— 表示通过表单方式提交
    application/json —— 表示传入数据为json格式字符串


**查询参数：**

+------------------------+------------+------------+------------------------------------------------+
|**参数**                |**数据类型**|**是否必须**|**说明**                                        |
+------------------------+------------+------------+------------------------------------------------+
| offset                 | int        | 否         | 数据起始位置                                   |
+------------------------+------------+------------+------------------------------------------------+
| limit                  | int        | 否         | 查询条数                                       |
+------------------------+------------+------------+------------------------------------------------+
| name                   | string     | 否         | 凭证名称                                       |
+------------------------+------------+------------+------------------------------------------------+
| search                 | string     | 否         | 模糊查询，查询字段为name和description          |
+------------------------+------------+------------+------------------------------------------------+



**输入参数（新增）：**

+------------------------+------------+------------+------------------------------------------------+
|**参数**                |**数据类型**|**是否必须**|**说明**                                        |
+------------------------+------------+------------+------------------------------------------------+
| name                   | string     | 是         |  模板名称                                      |
+------------------------+------------+------------+------------------------------------------------+
| description            | string     | 否         | 描述                                           |
+------------------------+------------+------------+------------------------------------------------+
| template_type          | string     | 是         | 模版类型                                       |
+------------------------+------------+------------+------------------------------------------------+
| job_type               | string     | 是         | 运行模式                                       |
+------------------------+------------+------------+------------------------------------------------+
| inventory              | int        | 否         |  主机清单                                      |
+------------------------+------------+------------+------------------------------------------------+
| inventory_name         | string     | 否         |  主机清单中文名称                              |
+------------------------+------------+------------+------------------------------------------------+
| project                | int        | 否         |  自动化项目                                    |
+------------------------+------------+------------+------------------------------------------------+
| project_name           | string     | 否         |  自动化项目中文名称                            |
+------------------------+------------+------------+------------------------------------------------+
| playbook               | string     | 否         |  playbook                                      |
+------------------------+------------+------------+------------------------------------------------+
| credential             | int        | 否         | 凭据                                           |
+------------------------+------------+------------+------------------------------------------------+
| credential_name        | string     | 否         |  凭据id中文名称                                |
+------------------------+------------+------------+------------------------------------------------+
| forks                  | int        | 否         |  并发数                                        |
+------------------------+------------+------------+------------------------------------------------+
| limit                  | string     | 否         |  limit                                         |
+------------------------+------------+------------+------------------------------------------------+
| tags                   | string     | 否         |  tags                                          |
+------------------------+------------+------------+------------------------------------------------+
| skip_tags              | string     | 否         |  skip_tags                                     |
+------------------------+------------+------------+------------------------------------------------+
| verbosity              | int        | 否         | Debug级别                                      |
+------------------------+------------+------------+------------------------------------------------+
| variables              | string     | 否         |  扩展参数                                      |
+------------------------+------------+------------+------------------------------------------------+
| become_enabled         | int        | 否         |  是否允许切换用户                              |
+------------------------+------------+------------+------------------------------------------------+
| become_enabled_name    | string     | 否         |  是否允许切换用户中文名称                      |
+------------------------+------------+------------+------------------------------------------------+
| diff_mode              | int        | 否         | 是否使用diff模块                               |
+------------------------+------------+------------+------------------------------------------------+
| diff_mode_name         | string     | 否         | 是否使用diff模块中文名称                       |
+------------------------+------------+------------+------------------------------------------------+
| force_handlers         | int        | 否         | 是否强制允许handlers任务                       |
+------------------------+------------+------------+------------------------------------------------+
| force_handlers_name    | string     | 否         | 是否强制允许handlers任务中文名称               |
+------------------------+------------+------------+------------------------------------------------+
| start_at_task          | string     | 否         |  开始任务                                      |
+------------------------+------------+------------+------------------------------------------------+
| cuser                  | string     | 否         |  用户名                                        |
+------------------------+------------+------------+------------------------------------------------+
| bind_templates         | int        | 否         | 已绑定工作流                                   |
+------------------------+------------+------------+------------------------------------------------+
| is_bind_templates      | int        | 否         |  是否被绑定工作流                              |
+------------------------+------------+------------+------------------------------------------------+

**输出参数：**

+------------------------+------------+------------+------------------------------------------------+
|**参数**                |**数据类型**|**是否必须**|**说明**                                        |
+------------------------+------------+------------+------------------------------------------------+
| id                     | int        | 是         | template id                                    |
+------------------------+------------+------------+------------------------------------------------+
| name                   | string     | 是         |  模板名称                                      |
+------------------------+------------+------------+------------------------------------------------+
| description            | string     | 否         | 描述                                           |
+------------------------+------------+------------+------------------------------------------------+
| template_type          | string     | 是         | 模版类型                                       |
+------------------------+------------+------------+------------------------------------------------+
| job_type               | string     | 是         | 运行模式                                       |
+------------------------+------------+------------+------------------------------------------------+
| inventory              | int        | 否         |  主机清单                                      |
+------------------------+------------+------------+------------------------------------------------+
| inventory_name         | string     | 否         |  主机清单中文名称                              |
+------------------------+------------+------------+------------------------------------------------+
| project                | int        | 否         |  自动化项目                                    |
+------------------------+------------+------------+------------------------------------------------+
| project_name           | string     | 否         |  自动化项目中文名称                            |
+------------------------+------------+------------+------------------------------------------------+
| playbook               | string     | 否         |  playbook                                      |
+------------------------+------------+------------+------------------------------------------------+
| credential             | int        | 否         | 凭据                                           |
+------------------------+------------+------------+------------------------------------------------+
| credential_name        | string     | 否         |  凭据id中文名称                                |
+------------------------+------------+------------+------------------------------------------------+
| forks                  | int        | 否         |  并发数                                        |
+------------------------+------------+------------+------------------------------------------------+
| limit                  | string     | 否         |  limit                                         |
+------------------------+------------+------------+------------------------------------------------+
| tags                   | string     | 否         |  tags                                          |
+------------------------+------------+------------+------------------------------------------------+
| skip_tags              | string     | 否         |  skip_tags                                     |
+------------------------+------------+------------+------------------------------------------------+
| verbosity              | int        | 否         | Debug级别                                      |
+------------------------+------------+------------+------------------------------------------------+
| variables              | string     | 否         |  扩展参数                                      |
+------------------------+------------+------------+------------------------------------------------+
| become_enabled         | int        | 否         |  是否允许切换用户                              |
+------------------------+------------+------------+------------------------------------------------+
| become_enabled_name    | string     | 否         |  是否允许切换用户中文名称                      |
+------------------------+------------+------------+------------------------------------------------+
| diff_mode              | int        | 否         | 是否使用diff模块                               |
+------------------------+------------+------------+------------------------------------------------+
| diff_mode_name         | string     | 否         | 是否使用diff模块中文名称                       |
+------------------------+------------+------------+------------------------------------------------+
| force_handlers         | int        | 否         | 是否强制允许handlers任务                       |
+------------------------+------------+------------+------------------------------------------------+
| force_handlers_name    | string     | 否         | 是否强制允许handlers任务中文名称               |
+------------------------+------------+------------+------------------------------------------------+
| start_at_task          | string     | 否         |  开始任务                                      |
+------------------------+------------+------------+------------------------------------------------+
| cuser                  | string     | 否         |  用户名                                        |
+------------------------+------------+------------+------------------------------------------------+
| bind_templates         | int        | 否         | 已绑定工作流                                   |
+------------------------+------------+------------+------------------------------------------------+
| is_bind_templates      | int        | 否         |  是否被绑定工作流                              |
+------------------------+------------+------------+------------------------------------------------+

**批量删除参数：**

+------------------------+------------+-------------------+-------------------------------------------------+
|**参数**                |**数据类型**|**是否必须**       |**说明**                                         |
+------------------------+------------+-------------------+-------------------------------------------------+
| pk                     | string     | 与pk[]不能都为空  | 主键，多个主键用半角逗号隔开。通过http body传入 |
+------------------------+------------+-------------------+-------------------------------------------------+
| pk[]                   | array      | 与pk不能都为空    | 主键数组。通过http body传入                     |
+------------------------+------------+-------------------+-------------------------------------------------+

**排序：**

+------------------------+------------+-------------------+---------------------------------------------------+
|**参数**                |**数据类型**|**是否必须**       |**说明**                                           |
+------------------------+------------+-------------------+---------------------------------------------------+
|                        |            |                   |   一般默认按id倒叙                                |
| ordering               | string     | 否                | - ordering=id表示按id排序ordering=-id表示按id倒叙 |
|                        |            |                   | - 多个字段排序用半角逗号分隔                      |
+------------------------+------------+-------------------+---------------------------------------------------+

**GET返回数据例子：**
::
    {
        "count": 9,
        "next": null,
        "previous": null,
        "results": [
            {
                "id": 31,
                "description": "",
                "template_type": "job",
                "job_type": "run",
                "playbook": "site.yml",
                "credential": 29,
                "inventory": 18,
                "inventory_name": "阿里云主机",
                "project_name": "tomcat playbook",
                "project": 17,
                "forks": 0,
                "limit": "",
                "verbosity": 0,
                "become_enabled": 0,
                "variables": "tomcat_version: 8.5.42\r\n\r\n# Here are variables related to the Tomcat installation\r\n\r\nhttp_port: 8080\r\nhttps_port: 8443\r\n\r\n# This will configure a default manager-gui user:\r\n\r\nadmin_username: admin\r\nadmin_password: admin\r\n\r\ntomcat_downloadURL: http://mirror.bit.edu.cn/apache",
                "credential_name": "泛汐服务器（root用户名密码）",
                "name": "tomcat安装",
                "diff_mode": 0,
                "force_handlers": 0,
                "start_at_task": "",
                "tags": "",
                "skip_tags": "",
                "jobtype_name": "Run",
                "verbosity_name": "Normal",
                "cuser": 48,
                "bind_templates": [],
                "is_bind_templates": "否"
            },
            {
                "id": 30,
                "description": "",
                "template_type": "job",
                "job_type": "run",
                "playbook": "main.yml",
                "credential": 29,
                "inventory": 9,
                "inventory_name": "百度云和腾讯云主机",
                "project_name": "修改密码",
                "project": 8,
                "forks": 0,
                "limit": "",
                "verbosity": 0,
                "become_enabled": 0,
                "variables": "",
                "credential_name": "泛汐服务器（root用户名密码）",
                "name": "修改密码模板",
                "diff_mode": 0,
                "force_handlers": 0,
                "start_at_task": "",
                "tags": "",
                "skip_tags": "",
                "jobtype_name": "Run",
                "verbosity_name": "Normal",
                "cuser": 48,
                "bind_templates": [],
                "is_bind_templates": "否"
                }
            ]
        }

**新增凭证返回数据例子：**
::
    {
        "id": 30,
        "description": "",
        "template_type": "job",
        "job_type": "run",
        "playbook": "main.yml",
        "credential": 29,
        "inventory": 9,
        "inventory_name": "百度云和腾讯云主机",
        "project_name": "修改密码",
        "project": 8,
        "forks": 0,
        "limit": "",
        "verbosity": 0,
        "become_enabled": 0,
        "variables": "",
        "credential_name": "泛汐服务器（root用户名密码）",
        "name": "修改密码模板",
        "diff_mode": 0,
        "force_handlers": 0,
        "start_at_task": "",
        "tags": "",
        "skip_tags": "",
        "jobtype_name": "Run",
        "verbosity_name": "Normal",
        "cuser": 48,
        "bind_templates": [],
        "is_bind_templates": "否"
        }


2、获取单个模板，修改模板、删除模板 API
--------------------------------------

**请求方式：**    GET（查询） PUT（修改） PATCH（修改） DELETE（删除）

**请求地址：**    /api/template/template/30/
::

    请求地址中30为模板的id


**输入/输出参数：**   见章节1中输入和输出参数说明，修改数据时输入参数均为非必须

**返回数据例子：**
::
    {
        "id": 30,
        "description": "",
        "template_type": "job",
        "job_type": "run",
        "playbook": "main.yml",
        "credential": 29,
        "inventory": 9,
        "inventory_name": "百度云和腾讯云主机",
        "project_name": "修改密码",
        "project": 8,
        "forks": 0,
        "limit": "",
        "verbosity": 0,
        "become_enabled": 0,
        "variables": "",
        "credential_name": "泛汐服务器（root用户名密码）",
        "name": "修改密码模板",
        "diff_mode": 0,
        "force_handlers": 0,
        "start_at_task": "",
        "tags": "",
        "skip_tags": "",
        "jobtype_name": "Run",
        "verbosity_name": "Normal",
        "cuser": 48,
        "bind_templates": [],
        "is_bind_templates": "否"
        }
